<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:shared="clr-namespace:Syncfusion.Windows.Shared;assembly=Syncfusion.Shared.WPF"
    xmlns:tools="clr-namespace:Syncfusion.Windows.Tools.Controls;assembly=Syncfusion.Tools.WPF"
    xmlns:provider="clr-namespace:Syncfusion.SfSkinManager;assembly=Syncfusion.SfSkinManager.WPF"
    xmlns:windows_shared="clr-namespace:Syncfusion.Windows;assembly=Syncfusion.Shared.Wpf">
    
    <ResourceDictionary.MergedDictionaries>
        <provider:ResourceDictionaryProvider DictionaryName="Common" ThemeName="MaterialDark"/>
        <provider:ResourceDictionaryProvider DictionaryName="Brushes" ThemeName="MaterialDark"/>
        <ResourceDictionary Source="/Syncfusion.Themes.MaterialDark.WPF;component/MSControl/Separator.xaml" />
        <ResourceDictionary Source="/Syncfusion.Themes.MaterialDark.WPF;component/MSControl/ScrollViewer.xaml" />
        <ResourceDictionary Source="/Syncfusion.Themes.MaterialDark.WPF;component/MSControl/ToggleButton.xaml" />
        <ResourceDictionary Source="/Syncfusion.Themes.MaterialDark.WPF;component/MSControl/Menu.xaml" />
        <ResourceDictionary Source="/Syncfusion.Themes.MaterialDark.WPF;component/Ribbon/RibbonButton.xaml"/>

    </ResourceDictionary.MergedDictionaries>

    <shared:DisableEffect x:Key="DisableEffect" />
    <tools:TextWrappingConverter x:Key="TextWrappingConverter" />

    <ContentControl x:Key="DropDownPath">
        <ContentControl.Style>
            <Style>
                <Setter Property="Control.OverridesDefaultStyle" Value="True" />
                <Setter Property="Control.HorizontalAlignment" Value="Center" />
                <Setter Property="Control.VerticalAlignment" Value="Top" />
                <Setter Property="Control.Height" Value="14" />
                <Setter Property="Control.Margin" Value="0,-1,0,0" />
                <Setter Property="Control.Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ContentControl">
                            <Border>
                                <Path            x:Name="path"
                                                 Width="5"
                                                 Height="3"
                                                 Margin="0,4,0,0"
                                                 HorizontalAlignment="Center"
                                                 Data="M0,0 L100.25,0 100.25,20 80,20 80,39.75 60.5,39.75 60.5,60 39.75,60 39.75,39.75 20.75,39.75 20.75,20 0,20 z"
                                                 Fill="{StaticResource IconColor}"
                                                 Stretch="Fill" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <DataTrigger Binding="{Binding Path=IsDropDownOpen, RelativeSource={RelativeSource AncestorType={x:Type tools:RibbonItemsControl}}}" Value="True">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Path=IsEnabled, RelativeSource={RelativeSource AncestorType={x:Type tools:RibbonItemsControl}}}" Value="False">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconDisabledColor}" />
                                </DataTrigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ContentControl.Style>
    </ContentControl>

    <!--  DropDownButton style for QuickAccessToolBar  -->
    <Style x:Key="SyncfusionQuickAccessPopupDropDownButtonStyle" TargetType="{x:Type tools:DropDownButton}">
    <Setter Property="OverridesDefaultStyle" Value="true" />
    <Setter Property="Width" Value="11" />
    <Setter Property="Height" Value="21" />
    <Setter Property="windows_shared:WindowChrome.IsHitTestVisibleInChrome" Value="True" />
    <Setter Property="Background" Value="Transparent" />
    <Setter Property="IsTabStop" Value="false" />
    <Setter Property="ButtonBase.ClickMode">
        <Setter.Value>
            <x:Static Member="ClickMode.Press" />
        </Setter.Value>
    </Setter>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type tools:DropDownButton}">
                <Border
                        Name="PART_ToggleButton"
                        Width="13"
                        Height="{TemplateBinding Height}"
                        Background="{TemplateBinding Panel.Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}">
                    <Grid>
                        <Grid
                                Height="17"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="5*" />
                                <RowDefinition Height="5*" />
                            </Grid.RowDefinitions>
                            <Rectangle
                                    x:Name="path1"
                                    Width="5"
                                    Height="1"
                                    Margin="0,4,0,0"
                                    VerticalAlignment="Center"
                                    Stroke="{StaticResource IconColor}" />
                            <Path
                                    x:Name="path2"
                                    Grid.Row="1"
                                    Width="5"
                                    Height="3"
                                    Margin="0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Top"
                                    Data="M0,0 L100.25,0 100.25,20 80,20 80,39.75 60.5,39.75 60.5,60 39.75,60 39.75,39.75 20.75,39.75 20.75,20 0,20 z"
                                    Fill="{StaticResource IconColor}"
                                    Stretch="Fill" />
                        </Grid>
                        <Popup
                                Name="PART_Popup"
                                AllowsTransparency="True"
                                Focusable="False"
                                IsOpen="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource AncestorType={x:Type tools:DropDownButton}}}"
                                Placement="Bottom"
                                PopupAnimation="Fade"
                                StaysOpen="False">

                            <Border
                                    Background="{StaticResource PopupBackground}"
                                    BorderBrush="{StaticResource BorderAlt}"
                                    BorderThickness="{StaticResource MaterialDark.BorderThickness1}"
                                    Effect="{StaticResource Default.ShadowDepth3}">
                                    <Border.Margin>
                                                <Thickness>8,0,8,8</Thickness>
                                    </Border.Margin>
                                    <ItemsPresenter />
                            </Border>

                        </Popup>
                    </Grid>
                </Border>
                <ControlTemplate.Triggers>

                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                        <Setter TargetName="path2" Property="Fill" Value="{StaticResource IconColor}" />
                        <Setter TargetName="path1" Property="Stroke" Value="{StaticResource IconColor}" />
                    </Trigger>
                    <Trigger Property="IsDropDownOpen" Value="True">
                        <Setter Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                        <Setter TargetName="path2" Property="Fill" Value="{StaticResource IconColor}" />
                        <Setter TargetName="path1" Property="Stroke" Value="{StaticResource IconColor}" />
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Background" Value="Transparent" />
                        <Setter TargetName="path2" Property="Fill" Value="{StaticResource IconDisabledColor}" />
                        <Setter TargetName="path1" Property="Stroke" Value="{StaticResource IconDisabledColor}" />
                    </Trigger>
                    <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                        <Setter Property="MinHeight" Value="30" />
                        <Setter Property="MinWidth" Value="30" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>

<!--  DropDownButton style for OverflowButton  -->
    <Style x:Key="SyncfusionRibbonOverflowDropDownButtonStyle" TargetType="{x:Type tools:DropDownButton}">
    <Setter Property="OverridesDefaultStyle" Value="true" />
    <Setter Property="Width" Value="15" />
    <Setter Property="Height" Value="20" />
    <Setter Property="BorderThickness" Value="{StaticResource MaterialDark.BorderThickness1}" />
    <Setter Property="Background" Value="Transparent" />
    <Setter Property="BorderBrush" Value="Transparent" />
    <Setter Property="IsTabStop" Value="false" />
    <Setter Property="ButtonBase.ClickMode">
        <Setter.Value>
            <x:Static Member="ClickMode.Press" />
        </Setter.Value>
    </Setter>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type tools:DropDownButton}">
                <Border
                        Name="PART_ToggleButton"
                        Width="{TemplateBinding Width}"
                        Height="{TemplateBinding Height}"
                        Background="{TemplateBinding Panel.Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        SnapsToDevicePixels="True">
                    <Grid>
                        <Path
                                x:Name="path"
                                Data="{TemplateBinding PathGeometry}"
                                Fill="{StaticResource IconColor}"
                                Stroke="{StaticResource IconColor}"
                                StrokeThickness="{StaticResource MaterialDark.StrokeThickness1}" />
                        <Popup
                                Name="PART_Popup"
                                AllowsTransparency="True"
                                Focusable="False"
                                IsOpen="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource AncestorType={x:Type tools:DropDownButton}}}"
                                Placement="Bottom"
                                PopupAnimation="Fade"
                                StaysOpen="False">

                            <Border
                                    Background="{StaticResource PopupBackground}"
                                    BorderBrush="{StaticResource BorderAlt}"
                                    BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                    Margin="8,0,8,8"
                                    Effect="{StaticResource Default.ShadowDepth3}">
                                <ItemsPresenter />
                            </Border>

                        </Popup>
                    </Grid>
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                        <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                        <Setter TargetName="path" Property="Stroke" Value="{StaticResource IconColor}" />
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Background" Value="Transparent" />
                        <Setter TargetName="path" Property="Fill" Value="{StaticResource IconDisabledColor}" />
                        <Setter TargetName="path" Property="Stroke" Value="{StaticResource IconDisabledColor}" />
                    </Trigger>

                    <Trigger Property="IsDropDownOpen" Value="True">
                        <Setter Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                        <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                        <Setter TargetName="path" Property="Stroke" Value="{StaticResource IconColor}" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>

    <!--  DropDownButton style for the overflow button in Simplified Ribbon  -->
    <Style x:Key="SyncfusionSimplifiedOverflowDropDownButtonStyle" BasedOn="{StaticResource SyncfusionRibbonOverflowDropDownButtonStyle}" TargetType="{x:Type tools:DropDownButton}">
        <Setter Property="Width" Value="38" />
        <Setter Property="BorderThickness" Value="{StaticResource MaterialDark.BorderThickness}" />
        <Setter Property="Margin" Value="1,0,0,0"/>
        <Setter Property="PathGeometry">
            <Setter.Value>
                <GeometryGroup>
                    <EllipseGeometry Center="11,21" RadiusX="1.5" RadiusY="1.5"/>
                    <EllipseGeometry Center="18.5,21" RadiusX="1.5" RadiusY="1.5"/>
                    <EllipseGeometry Center="26,21" RadiusX="1.5" RadiusY="1.5"/>
                </GeometryGroup>
            </Setter.Value>
        </Setter>
    </Style>
	
	<DataTemplate x:Key="RibbonItemVectorImageTemplate">
        <Grid>
            <Viewbox Name="VectorImage">
                <Viewbox.Child>
                    <Grid x:Name="PathGrid" />
                </Viewbox.Child>
            </Viewbox>
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="DropDownButtonIconTemplate">
        <Grid>
            <Image RenderOptions.BitmapScalingMode="NearestNeighbor" Stretch="{Binding IconStretch, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools:DropDownButton}}}" 
  x:Name="PART_Image" Source="{Binding Tag, RelativeSource={RelativeSource TemplatedParent }}" />
        </Grid>
    </DataTemplate>
    
    <DataTemplate x:Key="SplitButtonIconTemplate">
        <Grid>
            <Image RenderOptions.BitmapScalingMode="NearestNeighbor" Stretch="{Binding IconStretch, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type tools:SplitButton}}}" 
  x:Name="PART_Image" Source="{Binding Tag, RelativeSource={RelativeSource TemplatedParent }}" />
        </Grid>
    </DataTemplate>

    <!--  DropDownButton style for RibbonBar  -->
    <Style x:Key="SyncfusionRibbonBarDropDownButtonStyle" TargetType="{x:Type tools:DropDownButton}">
        <Setter Property="BorderThickness" Value="{StaticResource MaterialDark.BorderThickness}" />
        <Setter Property="Foreground" Value="{StaticResource SecondaryForeground}" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Focusable" Value="False" />
        <Setter Property="HorizontalAlignment" Value="Center" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type tools:DropDownButton}">
                    <Border
                        Name="PART_ToggleButton"
                        Background="{TemplateBinding Background}"
                        BorderBrush="Transparent"
                        BorderThickness="{TemplateBinding BorderThickness}">
                        <Grid>
                            <StackPanel Orientation="Vertical">
                                <Border
                                Name="PART_ImageBorder"
                                Margin="3"
                                Background="Transparent"
                                BorderBrush="Transparent"
                                BorderThickness="{StaticResource MaterialDark.BorderThickness1}"
                                DockPanel.Dock="Top">
                                    <Grid MinWidth="31" MinHeight="31">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="*" />
                                            <RowDefinition Height="7" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <ContentPresenter Name="IconContent" ContentTemplate="{TemplateBinding IconTemplate}" Content="{Binding }" Height="16" Width="16"/>
                                    </Grid>
                                </Border>
                                <tools:CustomItemsControl
                                x:Name="label"
                                Margin="3,4,3,1"
                                DockPanel.Dock="Bottom"
                                Focusable="False"
                                Foreground="{TemplateBinding Foreground}"
                                ItemsSource="{Binding Path=Label, Mode=OneWay, Converter={StaticResource TextWrappingConverter}, RelativeSource={RelativeSource TemplatedParent}}">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <tools:MultilinePanel />
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                </tools:CustomItemsControl>
                                <Path
                                     x:Name="path"
                                     Width="5"
                                     Height="3"
                                     Margin="0,-3,0,3"
                                     HorizontalAlignment="Center"
                                     Data="M0,0 L100.25,0 100.25,20 80,20 80,39.75 60.5,39.75 60.5,60 39.75,60 39.75,39.75 20.75,39.75 20.75,20 0,20 z"
                                     Fill="{StaticResource IconColor}"
                                     Stretch="Fill" />
                                <Popup
                                Name="PART_Popup"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                AllowsTransparency="True"
                                Focusable="False"
                                IsOpen="{Binding Path=IsDropDownOpen, RelativeSource={RelativeSource AncestorType={x:Type tools:DropDownButton}}}"
                                Placement="Bottom"
                                PlacementTarget="{Binding ElementName=PART_ToggleButton}"
                                PopupAnimation="Fade"
                                StaysOpen="False">
                                    <Border BorderThickness="{StaticResource MaterialDark.BorderThickness1}"
                                        Effect="{StaticResource Default.ShadowDepth5}">
                                        <ItemsPresenter />
                                    </Border>
                                </Popup>
                            </StackPanel>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
						<MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IconTemplate" Value="{x:Null}"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="IconContent" Property="Tag" Value="{Binding LargeIcon, RelativeSource={RelativeSource TemplatedParent}}" />
                            <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource DropDownButtonIconTemplate}"/>
                        </MultiTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding ElementName=PART_ToggleButton, Path=IsMouseOver}" Value="True" />
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                        </MultiDataTrigger>
                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsDropDownOpen}" Value="True" />
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                            <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                        </MultiDataTrigger>
                        <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                            <Setter TargetName="PART_ImageBorder" Property="FrameworkElement.Height" Value="38" />
                            <Setter TargetName="PART_ImageBorder" Property="FrameworkElement.Width" Value="38" />
                            <Setter TargetName="label" Property="Margin" Value="3,15,3,1" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  DropDown Button Style  -->
    <Style x:Key="SyncfusionRibbonDropDownButtonStyle" TargetType="{x:Type tools:DropDownButton}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Foreground" Value="{StaticResource SecondaryForeground}" />
        <Setter Property="BorderThickness" Value="{StaticResource MaterialDark.BorderThickness}" />
        <Setter Property="Label" Value="New Button" />
        <Setter Property="HorizontalAlignment" Value="Center" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="Opacity" Value="1"/>
        <Setter Property="LargeIcon" Value="pack://application:,,,/Syncfusion.Tools.WPF;component/Framework/Ribbon/Resources/WordArt32.png" />
        <Setter Property="SmallIcon" Value="pack://application:,,,/Syncfusion.Tools.WPF;component/Framework/Ribbon/Resources/WordArt16.png" />
        <Setter Property="MediumIcon" Value="pack://application:,,,/Syncfusion.Tools.WPF;component/Framework/Ribbon/Resources/WordArt20.png"/>
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <StackPanel />
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="SizeForm" Value="ExtraSmall">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools:DropDownButton}">
                            <Border
                                Name="PART_ToggleButton"
                                MinHeight="22"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="True">
                                <Grid>

                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Border
                                        Grid.Column="0"
                                        Margin="1"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        SnapsToDevicePixels="True">
                                        <ContentPresenter 
                                    Name="IconContent" ContentTemplateSelector="{TemplateBinding IconTemplateSelector}" ContentTemplate="{TemplateBinding IconTemplate}" Content="{Binding }" Height="16" Width="16"/>
                                    </Border>

                                    <Path
                                        x:Name="path"
                                        Grid.Column="1"
                                        Width="5"
                                        Height="3"
                                        Margin="3,5"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Data="M0,0 L100.25,0 100.25,20 80,20 80,39.75 60.5,39.75 60.5,60 39.75,60 39.75,39.75 20.75,39.75 20.75,20 0,20 z"
                                        Fill="{StaticResource IconColor}"
                                        Focusable="False"
                                        SnapsToDevicePixels="True"
                                        Stretch="Fill" />

                                    <Popup
                                        Name="PART_Popup"
                                        AllowsTransparency="True"
                                        Focusable="False"
                                        IsOpen="{Binding Path=IsDropDownOpen, RelativeSource={RelativeSource AncestorType={x:Type tools:DropDownButton}}}"
                                        Placement="Bottom"
                                        PopupAnimation="Fade"
                                        StaysOpen="False">

                                        <Border
                                            MinWidth="28"
                                            MinHeight="14"
                                            Background="Transparent"
                                            BorderBrush="{StaticResource BorderAlt}"
                                            BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                            Effect="{StaticResource Default.ShadowDepth3}">
                                            <Border.Margin>
                                                        <Thickness>8,0,8,8</Thickness>
                                            </Border.Margin>
                                            <ScrollViewer Style="{StaticResource WPFMenuScrollViewer}">
                                                <ItemsPresenter
                                                    Name="Presenter"
                                                    Margin="0"
                                                    Grid.IsSharedSizeScope="true"
                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                    KeyboardNavigation.TabNavigation="Cycle"
                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                            </ScrollViewer>
                                        </Border>

                                    </Popup>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="tools:Ribbon.IsQATItem" Value="True"/>
                                        <Condition Property="IsMouseOver" Value="False"/>
                                        <Condition Property="IsDropDownOpen" Value="False"/>
                                        <Condition Property="IsPressed" Value="False"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="Foreground" Value="{StaticResource SecondaryForeground}"/>
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource SecondaryForeground}"/>
                                    <Setter Property="Background" Value="Transparent"/>
                                </MultiTrigger>
                              <MultiTrigger >
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="VectorImage"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource RibbonItemVectorImageTemplate}"/>
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="Icon"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                   <Setter TargetName="IconContent" Property="Tag" Value="{Binding SmallIcon, RelativeSource={RelativeSource TemplatedParent}}" />
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource DropDownButtonIconTemplate}"/>
                                </MultiTrigger>

                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                </Trigger>

                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                </Trigger>

                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                </Trigger>

                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="IconContent" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconDisabledColor}" />
                                    <Setter Property="Opacity" Value="0.5"/>
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Padding" Value="5" />
                                    <Setter TargetName="IconContent" Property="MinHeight" Value="20" />
                                    <Setter TargetName="IconContent" Property="MinWidth" Value="20" />
                                    <Setter TargetName="PART_ToggleButton" Property="MinWidth" Value="47" />
                                    <Setter TargetName="PART_ToggleButton" Property="MinHeight" Value="30" />
                                </Trigger>
                             </ControlTemplate.Triggers>

                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>

            <Trigger Property="SizeForm" Value="Small">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools:DropDownButton}">
                            <Border
                                Name="PART_ToggleButton"
                                MinHeight="22"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Opacity="{TemplateBinding Opacity}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Border
                                        Name="PART_ImageBorder"
                                        Grid.Column="0"
                                        Margin="2,3">
                                        <ContentPresenter 
                                    Name="IconContent" ContentTemplateSelector="{TemplateBinding IconTemplateSelector}" ContentTemplate="{TemplateBinding IconTemplate}" Content="{Binding }" Height="16" Width="16"/>
                                    </Border>
                                    <tools:RibbonAutomatableTextBlock
                                        x:Name="label"
                                        Grid.Column="1"
                                        Margin="2,3,4,0"
                                        HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                                        VerticalAlignment="{TemplateBinding VerticalAlignment}"
                                        FontFamily="{TemplateBinding FontFamily}"
                                        Foreground="{TemplateBinding Foreground}"
                                        Text="{TemplateBinding Label}" />

                                    <Path
                                        x:Name="path"
                                        Grid.Column="2"
                                        Width="5"
                                        Height="3"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Data="M0,0 L100.25,0 100.25,20 80,20 80,39.75 60.5,39.75 60.5,60 39.75,60 39.75,39.75 20.75,39.75 20.75,20 0,20 z"
                                        Fill="{StaticResource IconColor}"
                                        Focusable="False"
                                        Stretch="Fill" />

                                    <Popup
                                        Name="PART_Popup"
                                        AllowsTransparency="True"
                                        Focusable="False"
                                        IsOpen="{Binding Path=IsDropDownOpen, RelativeSource={RelativeSource AncestorType={x:Type tools:DropDownButton}}}"
                                        Placement="Bottom"
                                        PopupAnimation="Fade"
                                        StaysOpen="False">
                                        <Border
                                            MinWidth="28"
                                            MinHeight="14"
                                            Background="{StaticResource PopupBackground}"
                                            BorderBrush="{StaticResource BorderAlt}"
                                            BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                    Effect="{StaticResource Default.ShadowDepth3}">
                                <Border.Margin>
                                            <Thickness>8,0,8,8</Thickness>
                                </Border.Margin>
                                            <ScrollViewer Style="{StaticResource WPFMenuScrollViewer}">
                                                <ItemsPresenter
                                                    Name="Presenter"
                                                    Margin="0"
                                                    Grid.IsSharedSizeScope="true"
                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                    KeyboardNavigation.TabNavigation="Cycle"
                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                            </ScrollViewer>
                                        </Border>

                                    </Popup>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <MultiTrigger >
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="VectorImage"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource RibbonItemVectorImageTemplate}"/>
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="Icon"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                   <Setter TargetName="IconContent" Property="Tag" Value="{Binding SmallIcon, RelativeSource={RelativeSource TemplatedParent}}" />
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource DropDownButtonIconTemplate}"/>
                                </MultiTrigger>
                                <Trigger Property="tools:SimplifiedLayoutSettings.ActiveDisplayMode" Value="OverflowMenu">
                                    <Setter TargetName="PART_ToggleButton" Property="Padding" Value="3,3,0,3"/>
                                    <Setter TargetName="label" Property="Margin" Value="6,2,15,0"/>
                                    <Setter TargetName="PART_ImageBorder" Property="Margin" Value="2"/>
                                    <Setter TargetName="path" Property="Margin" Value="0,0,5,0"/>
                                    <Setter Property="Margin" TargetName="IconContent" Value="2"/>
                                    <Setter TargetName="PART_Popup" Property="Placement" Value="Left"/>
                                    <Setter Property="RenderTransform" TargetName="path">
                                        <Setter.Value>
                                            <RotateTransform Angle="-90" CenterX="3" CenterY="2"/>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                                <Trigger Property="IsSmallImageVisible" Value="False">
                                    <Setter TargetName="PART_ImageBorder" Property="Visibility" Value="Collapsed" />
                                </Trigger>
                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                </Trigger>

                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                </Trigger>

                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                </Trigger>

                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconDisabledColor}" />
                                    <Setter TargetName="IconContent" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter Property="Opacity" Value="0.5"/>
                                </Trigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="True"/>
                                        <Condition Property="tools:SimplifiedLayoutSettings.ActiveDisplayMode" Value="OverflowMenu"/>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="Icon"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="IconContent" Property="Tag" Value="{Binding MediumIcon, RelativeSource={RelativeSource TemplatedParent}}" />
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="True"/>
                                        <Condition Property="tools:SimplifiedLayoutSettings.ActiveDisplayMode" Value="OverflowMenu"/>
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="PART_ToggleButton" Property="Padding" Value="5,4,0,4"/>
                                    <Setter Property="Margin" TargetName="IconContent" Value="5,2,2,2"/>
                                    <Setter TargetName="IconContent" Property="MinHeight" Value="20" />
                                    <Setter TargetName="IconContent" Property="MinWidth" Value="20" />
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="True"/>
                                        <Condition Property="tools:SimplifiedLayoutSettings.ActiveDisplayMode" Value="Normal"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="Padding" Value="5" />
                                    <Setter TargetName="IconContent" Property="MinHeight" Value="20" />
                                    <Setter TargetName="IconContent" Property="MinWidth" Value="20" />
                                    <Setter TargetName="PART_ToggleButton" Property="MinHeight" Value="30" />
                                    <Setter TargetName="PART_ToggleButton" Property="MinWidth" Value="47" />
                                </MultiTrigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>

            <Trigger Property="SizeForm" Value="Large">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools:DropDownButton}">
                            <Border
                                Name="PART_ToggleButton"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Opacity="{TemplateBinding Opacity}"
                                SnapsToDevicePixels="True">
                                <Grid>
                                    <StackPanel Orientation="Vertical">
                                        <Border
                                            Name="PART_ImageBorder"
                                            Margin="3"
                                            SnapsToDevicePixels="True">
                                            <ContentPresenter 
                                    Name="IconContent" ContentTemplateSelector="{TemplateBinding IconTemplateSelector}" ContentTemplate="{TemplateBinding IconTemplate}" Content="{Binding }" Height="32" Width="32"/>
                                        </Border>
                                        <tools:CustomItemsControl
                                            x:Name="label"
                                            Margin="2,3,2,2"
                                            Focusable="False"
                                            Path="{StaticResource DropDownPath}"
											Foreground="{TemplateBinding Foreground}"
											ItemsSource="{Binding Path=Label, Mode=OneWay, Converter={StaticResource TextWrappingConverter}, RelativeSource={RelativeSource TemplatedParent}}">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <tools:MultilinePanel HorizontalAlignment="{TemplateBinding HorizontalAlignment}" VerticalAlignment="{TemplateBinding VerticalAlignment}" />
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                        </tools:CustomItemsControl>
                                        <Popup
                                            Name="PART_Popup"
                                            AllowsTransparency="True"
                                            Focusable="False"
                                            IsOpen="{Binding Path=IsDropDownOpen, RelativeSource={RelativeSource AncestorType={x:Type tools:DropDownButton}}}"
                                            Placement="Bottom"
                                            PopupAnimation="Fade"
                                            StaysOpen="False"
                                            VerticalOffset="-2">
                                            <Border
                                                MinWidth="28"
                                                MinHeight="14"
                                                Background="{StaticResource PopupBackground}"
                                                BorderBrush="{StaticResource BorderAlt}"
                                                BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                                Effect="{StaticResource Default.ShadowDepth3}">
                                                <Border.Margin>
                                                            <Thickness>8,0,8,8</Thickness>
                                                </Border.Margin>
                                                <ScrollViewer Style="{StaticResource WPFMenuScrollViewer}">
                                                    <ItemsPresenter
                                                        Name="Presenter"
                                                        Margin="0"
                                                        Grid.IsSharedSizeScope="true"
                                                        KeyboardNavigation.DirectionalNavigation="Cycle"
                                                        KeyboardNavigation.TabNavigation="Cycle"
                                                        SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                                </ScrollViewer>
                                            </Border>
                                        </Popup>
                                    </StackPanel>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <MultiTrigger >
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="VectorImage"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource RibbonItemVectorImageTemplate}"/>
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="Icon"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                   <Setter TargetName="IconContent" Property="Tag" Value="{Binding LargeIcon, RelativeSource={RelativeSource TemplatedParent}}" />
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource DropDownButtonIconTemplate}"/>
                                </MultiTrigger>

                                <Trigger Property="IsLargeImageVisible" Value="False">
                                    <Setter TargetName="PART_ImageBorder" Property="Visibility" Value="Collapsed" />
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                                </Trigger>

                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                </Trigger>

                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                </Trigger>

                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="IconContent" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter Property="Opacity" Value="0.5"/>
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter TargetName="IconContent" Property="MinHeight" Value="48" />
                                    <Setter TargetName="IconContent" Property="MinWidth" Value="48" />
                                    <Setter TargetName="IconContent" Property="RenderOptions.BitmapScalingMode" Value="LowQuality" />
                                    <Setter TargetName="label" Property="Margin" Value="2,10,2,2" />
                                    <Setter TargetName="PART_ToggleButton" Property="MinHeight" Value="100" />
                                    <Setter TargetName="PART_ToggleButton" Property="MinWidth" Value="60" />
                                </Trigger>
                             </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="Background" Value="Transparent" />
            </Trigger>

            <Trigger Property="tools:SimplifiedLayoutSettings.LayoutMode" Value="Simplified">
                <Setter Property="BorderThickness" Value="{StaticResource MaterialDark.BorderThickness}" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools:DropDownButton}">
                            <Border x:Name="PART_ToggleButton"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    Opacity="{TemplateBinding Opacity}"
                                    SnapsToDevicePixels="True">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Border
                                        Name="PART_ImageBorder"
                                        Grid.Column="0">
                                        <ContentPresenter 
                                    Name="IconContent" ContentTemplateSelector="{TemplateBinding IconTemplateSelector}" ContentTemplate="{TemplateBinding IconTemplate}" Content="{Binding }" Height="20" Width="20"/>
                                    </Border>
                                    <tools:RibbonAutomatableTextBlock
                                        x:Name="label"
                                        Grid.Column="1"
                                        Margin="5,3,0,2"
                                        HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                                        VerticalAlignment="{TemplateBinding VerticalAlignment}"
                                        FontFamily="{TemplateBinding FontFamily}"
                                        Foreground="{TemplateBinding Foreground}"
                                        Text="{TemplateBinding Label}" />

                                    <Path
                                        x:Name="path"
                                        Grid.Column="2"
                                        Width="5"
                                        Height="3"
                                        Margin="5,0,0,0"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Data="M0,0 L100.25,0 100.25,20 80,20 80,39.75 60.5,39.75 60.5,60 39.75,60 39.75,39.75 20.75,39.75 20.75,20 0,20 z"
                                        Fill="{StaticResource IconColor}"
                                        Focusable="False"
                                        Stretch="Fill" />
                                    <Popup
                                        Name="PART_Popup"
                                        AllowsTransparency="True"
                                        Focusable="False"
                                        IsOpen="{Binding Path=IsDropDownOpen, RelativeSource={RelativeSource AncestorType={x:Type tools:DropDownButton}}}"
                                        Placement="Bottom"
                                        PopupAnimation="Fade"
                                        StaysOpen="False">
                                        <Border
                                            MinWidth="28"
                                            MinHeight="14"
                                            Background="{StaticResource PopupBackground}"
                                            BorderBrush="{StaticResource BorderAlt}"
                                            BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                            Effect="{StaticResource Default.ShadowDepth3}">
                                            <Border.Margin>
                                                        <Thickness>8,0,8,8</Thickness>
                                            </Border.Margin>
                                            <ScrollViewer Style="{StaticResource WPFMenuScrollViewer}">
                                                <ItemsPresenter
                                                    Name="Presenter"
                                                    Margin="0"
                                                    Grid.IsSharedSizeScope="true"
                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                    KeyboardNavigation.TabNavigation="Cycle"
                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                            </ScrollViewer>
                                        </Border>
                                    </Popup>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="Visibility" Value="Visible">
                                    <Setter Property="Height" Value="{Binding Path=ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type tools:RibbonBar}}}"/>
                                </Trigger>
                                <MultiTrigger >
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="VectorImage"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource RibbonItemVectorImageTemplate}"/>
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="Icon"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                   <Setter TargetName="IconContent" Property="Tag" Value="{Binding MediumIcon, RelativeSource={RelativeSource TemplatedParent}}" />
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource DropDownButtonIconTemplate}"/>
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="Width" Value="NaN"/>
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="PART_ToggleButton" Property="Padding" Value="7,0,7,0"/>
                                </MultiTrigger>
                                <Trigger Property="SizeForm" Value="ExtraSmall">
                                    <Setter TargetName="label" Property="Visibility" Value="Collapsed"/>
                                </Trigger>
                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                </Trigger>

                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                </Trigger>

                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                </Trigger>

                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconDisabledColor}" />
                                    <Setter TargetName="IconContent" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter Property="Opacity" Value="0.5"/>
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Padding" Value="5" />
                                    <Setter TargetName="IconContent" Property="MinHeight" Value="20" />
                                    <Setter TargetName="IconContent" Property="MinWidth" Value="20" />
                                    <Setter TargetName="PART_ToggleButton" Property="MinHeight" Value="30" />
                                    <Setter TargetName="PART_ToggleButton" Property="MinWidth" Value="47" />
                                </Trigger>
                             </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style BasedOn="{StaticResource SyncfusionRibbonDropDownButtonStyle}" TargetType="{x:Type tools:DropDownButton}" />

    <!--  Split Button Style  -->
    <Style x:Key="SyncfusionSplitButtonStyle" TargetType="{x:Type tools:SplitButton}">
        <Setter Property="Label" Value="New Button" />
        <Setter Property="LargeIcon" Value="pack://application:,,,/Syncfusion.Tools.WPF;component/Framework/Ribbon/Resources/WordArt32.png" />
        <Setter Property="SmallIcon" Value="pack://application:,,,/Syncfusion.Tools.WPF;component/Framework/Ribbon/Resources/WordArt16.png" />
        <Setter Property="BorderThickness" Value="{StaticResource MaterialDark.BorderThickness1}" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="Foreground" Value="{StaticResource SecondaryForeground}" />
        <Setter Property="FontFamily" Value="{StaticResource MaterialDark.ThemeFontFamily}" />
        <Setter Property="HorizontalAlignment" Value="Center" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="Opacity" Value="1"/>
        <Setter Property="MediumIcon" Value="pack://application:,,,/Syncfusion.Tools.WPF;component/Framework/Ribbon/Resources/WordArt20.png"/>
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <StackPanel />
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>

            <Trigger Property="SizeForm" Value="ExtraSmall">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools:SplitButton}">
                            <Border
                                Name="OuterBorder"
                                MinHeight="22"
                                BorderThickness="{StaticResource MaterialDark.BorderThickness1}"
                                Opacity="{TemplateBinding Opacity}"
                                SnapsToDevicePixels="True">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="12" />
                                    </Grid.ColumnDefinitions>
                                    <Border
                                        Name="PART_Button"
                                        Grid.Column="0"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                        SnapsToDevicePixels="True">
                                        <ContentPresenter Name="IconContent" HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
 ContentTemplateSelector="{TemplateBinding IconTemplateSelector}" ContentTemplate="{TemplateBinding IconTemplate}" Content="{Binding }" Height="16" Width="16"/>
                                    </Border>

                                    <tools:RibbonUIBorder
                                        Name="PART_ToggleButton"
                                        Grid.Column="1"
                                        Background="Transparent"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                        SnapsToDevicePixels="True"
                                        ToolTip="{TemplateBinding ToggleButtonToolTip}">

                                        <Path
                                            x:Name="PathData"
                                            Width="5"
                                            Height="3"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Data="M0,0 L100.25,0 100.25,20 80,20 80,39.75 60.5,39.75 60.5,60 39.75,60 39.75,39.75 20.75,39.75 20.75,20 0,20 z"
                                            Fill="{StaticResource IconColor}"
                                            Focusable="False"
                                            Stretch="fill"
                                            StrokeThickness="{StaticResource MaterialDark.StrokeThickness1}" />

                                    </tools:RibbonUIBorder>
                                    <Popup
                                        Name="PART_Popup"
                                        AllowsTransparency="True"
                                        Focusable="False"
                                        IsOpen="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource AncestorType={x:Type tools:DropDownButton}}}"
                                        Placement="Bottom"
                                        PopupAnimation="Fade"
                                        StaysOpen="False">

                                        <Border
                                            MinWidth="28"
                                            MinHeight="14"
                                            Background="{StaticResource PopupBackground}"
                                            BorderBrush="{StaticResource BorderAlt}"
                                            BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                            Effect="{StaticResource Default.ShadowDepth3}">
                                            <Border.Margin>
                                                        <Thickness>8,0,8,8</Thickness>
                                            </Border.Margin>
                                            <ScrollViewer Style="{StaticResource WPFMenuScrollViewer}">
                                                <ItemsPresenter
                                                    Name="Presenter"
                                                    Margin="0"
                                                    Grid.IsSharedSizeScope="true"
                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                    KeyboardNavigation.TabNavigation="Cycle"
                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                            </ScrollViewer>
                                        </Border>

                                    </Popup>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="tools:Ribbon.IsQATItem" Value="True"/>
                                        <Condition Property="IsPressed" Value="False"/>
                                        <Condition Property="IsDropDownOpen" Value="False"/>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="False"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="Foreground" Value="{StaticResource SecondaryForeground}"/>
                                    <Setter TargetName="PathData" Property="Fill" Value="{StaticResource SecondaryForeground}"/>
                                    <Setter Property="Background" Value="Transparent"/>
                                </MultiTrigger>
                                <MultiTrigger >
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="VectorImage"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource RibbonItemVectorImageTemplate}"/>
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="Icon"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                   <Setter TargetName="IconContent" Property="Tag" Value="{Binding SmallIcon, RelativeSource={RelativeSource TemplatedParent}}" />
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource SplitButtonIconTemplate}"/>
									<Setter Property="Margin" TargetName="IconContent" Value="3,1"/>
                                </MultiTrigger>
                                
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="IconContent" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter TargetName="PathData" Property="Fill" Value="{StaticResource IconDisabledColor}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="Transparent" />
                                    <Setter Property="Opacity" Value="0.5"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="PathData" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_ToggleButton" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="PathData" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                </MultiTrigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="PathData" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                </MultiTrigger>

                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="PathData" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />

                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="False" />
                                        <Condition Property="IsPressed" Value="True" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="PathData" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="PART_Button" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />

                                </MultiTrigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsPressed" Value="True" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="PathData" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="PART_Button" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />

                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="tools:Ribbon.IsQATItem" Value="True"/>
                                        <Condition Property="IsPressed" Value="False"/>
                                        <Condition Property="IsDropDownOpen" Value="False"/>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="True"/>
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="PathData" Property="Fill" Value="{StaticResource SecondaryForeground}"/>
                                </MultiTrigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="MinHeight" Value="27" />
                                    <Setter Property="Padding" Value="5" />
                                    <Setter TargetName="IconContent" Property="MinHeight" Value="20" />
                                    <Setter TargetName="IconContent" Property="MinWidth" Value="20" />
                                    <Setter TargetName="OuterBorder" Property="MinWidth" Value="47" />
                                    <Setter TargetName="OuterBorder" Property="MinHeight" Value="30" />
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="False">
                                    <Setter Property="MinHeight" Value="22" />
                                    <Setter Property="Padding" Value="0" />
                                    <Setter TargetName="OuterBorder" Property="MinHeight" Value="20" />
                                </Trigger>
                             </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>

            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="SizeForm" Value="Small" />
                    <Condition Property="HitTestArea" Value="LabelAndImage" />
                </MultiTrigger.Conditions>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools:SplitButton}">
                            <Border
                                Name="OuterBorder"
                                MinHeight="22"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Opacity="{TemplateBinding Opacity}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="14" />
                                    </Grid.ColumnDefinitions>

                                    <Border
                                        Name="PART_Button"
                                        Grid.Column="0"
                                        Background="Transparent"
                                        BorderBrush="Transparent"
                                        BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                        SnapsToDevicePixels="True">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <ContentPresenter Name="IconContent" HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
 ContentTemplateSelector="{TemplateBinding IconTemplateSelector}" ContentTemplate="{TemplateBinding IconTemplate}" Content="{Binding }" Height="16" Width="16"/>
                                            <tools:RibbonAutomatableTextBlock
                                                Name="label"
                                                Grid.Column="1"
                                                Margin="2,3,4,0"
                                                HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                                                VerticalAlignment="{TemplateBinding VerticalAlignment}"
                                                Foreground="{TemplateBinding Foreground}"
                                                FontFamily="{TemplateBinding FontFamily}"
                                                Text="{TemplateBinding Label}" />
                                        </Grid>
                                    </Border>

                                    <tools:RibbonUIBorder
                                        Name="PART_ToggleButton"
                                        Grid.Column="2"
                                        AutomationProperties.Name="DropDownButton"
                                        Background="Transparent"
                                        BorderBrush="Transparent"
                                        BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                        ToolTip="{TemplateBinding ToggleButtonToolTip}">
                                        <Grid AutomationProperties.Name="DropDownButton">
                                            <!--  <Rectangle Name="InnerPathToggle" Fill="{TemplateBinding Background}" RadiusX="2" RadiusY="2"/>  -->

                                            <Path
                                                x:Name="path"
                                                Width="5"
                                                Height="3"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Data="M0,0 L100.25,0 100.25,20 80,20 80,39.75 60.5,39.75 60.5,60 39.75,60 39.75,39.75 20.75,39.75 20.75,20 0,20 z"
                                                Fill="{StaticResource IconColor}"
                                                Focusable="False"
                                                Stretch="Fill" />

                                        </Grid>
                                    </tools:RibbonUIBorder>
                                    <Popup
                                        Name="PART_Popup"
                                        AllowsTransparency="True"
                                        Focusable="False"
                                        IsOpen="{Binding Path=IsDropDownOpen, RelativeSource={RelativeSource AncestorType={x:Type tools:DropDownButton}}}"
                                        Placement="Bottom"
                                        PopupAnimation="Fade"
                                        StaysOpen="False">

                                        <Border
                                            MinWidth="28"
                                            MinHeight="14"
                                            BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                            Effect="{StaticResource Default.ShadowDepth3}">
                                            <Border.Margin>
                                                        <Thickness>8,0,8,8</Thickness>
                                            </Border.Margin>
                                            <ScrollViewer Margin="1" Style="{StaticResource WPFMenuScrollViewer}">
                                                <ItemsPresenter
                                                    Name="Presenter"
                                                    Grid.IsSharedSizeScope="true"
                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                    KeyboardNavigation.TabNavigation="Cycle"
                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                            </ScrollViewer>
                                        </Border>

                                    </Popup>
                                </Grid>
                            </Border>

                            <ControlTemplate.Triggers>

                                <MultiTrigger >
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="VectorImage"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource RibbonItemVectorImageTemplate}"/>
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="Icon"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                   <Setter TargetName="IconContent" Property="Tag" Value="{Binding SmallIcon, RelativeSource={RelativeSource TemplatedParent}}" />
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource SplitButtonIconTemplate}"/>
									<Setter Property="Margin" TargetName="IconContent" Value="2"/>
									<Setter Property="Visibility" TargetName="IconContent" Value="Collapsed"/>
                                </MultiTrigger>
                                
                                <Trigger Property="IsSmallImageVisible" Value="True">
                                    <Setter TargetName="IconContent" Property="Visibility" Value="Visible" />
                                </Trigger>
                                <Trigger Property="tools:SimplifiedLayoutSettings.ActiveDisplayMode" Value="OverflowMenu">
                                    <Setter TargetName="PART_ToggleButton" Property="Padding" Value="0,4"/>
                                    <Setter TargetName="PART_Button" Property="Padding" Value="3,4,0,4"/>
                                    <Setter TargetName="IconContent" Property="Margin" Value="2"/>
                                    <Setter TargetName="label" Property="Margin" Value="6,2,15,0"/>
                                    <Setter TargetName="PART_Popup" Property="Placement" Value="Left"/>
                                    <Setter Property="RenderTransform" TargetName="path">
                                        <Setter.Value>
                                            <RotateTransform Angle="-90" CenterX="3" CenterY="2"/>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_ToggleButton" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                </MultiTrigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                </MultiTrigger>

                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />

                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="False" />
                                        <Condition Property="IsPressed" Value="True" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="PART_Button" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderThickness" Value="{StaticResource MaterialDark.BorderThickness0111}" />
                                </MultiTrigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="IconContent" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter Property="Opacity" Value="0.5"/>

                                </Trigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="True"/>
                                        <Condition Property="tools:SimplifiedLayoutSettings.ActiveDisplayMode" Value="OverflowMenu"/>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="Icon"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="IconContent" Property="Tag" Value="{Binding MediumIcon, RelativeSource={RelativeSource TemplatedParent}}" />
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="True"/>
                                        <Condition Property="tools:SimplifiedLayoutSettings.ActiveDisplayMode" Value="OverflowMenu"/>
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="PART_Button" Property="Padding" Value="5,5,0,5"/>
                                    <Setter Property="Margin" TargetName="IconContent" Value="5,2,2,2"/>
                                    <Setter TargetName="label" Property="Margin" Value="8,0,15,1"/>
                                    <Setter TargetName="IconContent" Property="MinHeight" Value="20" />
                                    <Setter TargetName="IconContent" Property="MinWidth" Value="20" />
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="shared:SkinStorage.EnableTouch" Value="True"/>
                                        <Condition Property="tools:SimplifiedLayoutSettings.ActiveDisplayMode" Value="Normal"/>
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="IconContent" Property="MinHeight" Value="20" />
                                    <Setter TargetName="IconContent" Property="MinWidth" Value="20" />
                                    <Setter TargetName="OuterBorder" Property="MinWidth" Value="47" />
                                    <Setter TargetName="OuterBorder" Property="MinHeight" Value="30" />
                                </MultiTrigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </MultiTrigger>

            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="SizeForm" Value="Small" />
                    <Condition Property="HitTestArea" Value="ImageOnly" />
                </MultiTrigger.Conditions>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools:SplitButton}">
                            <Border
                                Name="OuterBorder"
                                MinHeight="22"
                                BorderBrush="Transparent"
                                BorderThickness="{StaticResource MaterialDark.BorderThickness1}"
                                Opacity="{TemplateBinding Opacity}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <Border
                                        Name="PART_Button"
                                        Grid.Column="0"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Background="Transparent"
                                        BorderBrush="{TemplateBinding BorderBrush}" 
                                        BorderThickness="{StaticResource MaterialDark.BorderThickness}">
                                        <Border.CornerRadius>
                                                    <CornerRadius>3,0,0,3</CornerRadius>
                                        </Border.CornerRadius>
                                        <ContentPresenter Name="IconContent" ContentTemplateSelector="{TemplateBinding IconTemplateSelector}" ContentTemplate="{TemplateBinding IconTemplate}" Content="{Binding }" Height="16" Width="16"/>
                                    </Border>
                                    <tools:RibbonUIBorder
                                        Name="PART_ToggleButton"
                                        Grid.Column="1"
                                        AutomationProperties.Name="DropDownButton"
                                        BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                        ToolTip="{TemplateBinding ToggleButtonToolTip}">
                                        <Grid>
                                            <DockPanel>
                                                <tools:RibbonAutomatableTextBlock
                                                    Name="label"
                                                    Margin="2,0,2,0"
                                                    VerticalAlignment="Center"
                                                    DockPanel.Dock="Left"
                                                    Foreground="{TemplateBinding Foreground}"
                                                    FontFamily="{TemplateBinding FontFamily}"
                                                    Text="{TemplateBinding Label}" />
                                                <Path
                                                    x:Name="path"
                                                    Width="5"
                                                    Height="3"
                                                    Margin="2"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    Data="M0,0 L100.25,0 100.25,20 80,20 80,39.75 60.5,39.75 60.5,60 39.75,60 39.75,39.75 20.75,39.75 20.75,20 0,20 z"
                                                    Fill="{StaticResource IconColor}"
                                                    Stretch="Fill" />
                                            </DockPanel>
                                        </Grid>
                                    </tools:RibbonUIBorder>
                                    <Popup
                                        Name="PART_Popup"
                                        AllowsTransparency="True"
                                        Focusable="False"
                                        IsOpen="{Binding Path=IsDropDownOpen, RelativeSource={RelativeSource AncestorType={x:Type tools:DropDownButton}}}"
                                        Placement="Bottom"
                                        PopupAnimation="Fade"
                                        StaysOpen="False">
                                        <Border
                                            MinWidth="28"
                                            MinHeight="14"
                                            Background="Transparent"
                                            BorderBrush="{StaticResource BorderAlt}"
                                            BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                            Effect="{StaticResource Default.ShadowDepth3}">
                                            <Border.Margin>
                                                        <Thickness>8,0,8,8</Thickness>
                                            </Border.Margin>
                                            <ScrollViewer Style="{StaticResource WPFMenuScrollViewer}">
                                                <ItemsPresenter
                                                    Name="Presenter"
                                                    Margin="0"
                                                    Grid.IsSharedSizeScope="true"
                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                    KeyboardNavigation.TabNavigation="Cycle"
                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                            </ScrollViewer>
                                        </Border>

                                    </Popup>
                                </Grid>
                            </Border>

                            <ControlTemplate.Triggers>
                                <MultiTrigger >
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="VectorImage"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource RibbonItemVectorImageTemplate}"/>
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="Icon"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                   <Setter TargetName="IconContent" Property="Tag" Value="{Binding SmallIcon, RelativeSource={RelativeSource TemplatedParent}}" />
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource SplitButtonIconTemplate}"/>
									<Setter Property="Margin" TargetName="IconContent" Value="1"/>
                                </MultiTrigger>

                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_ToggleButton" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                </MultiTrigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                </MultiTrigger>

                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource BorderAlt}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconDisabledColor}" />
                                    <Setter TargetName="IconContent" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter Property="Opacity" Value="0.5"/>
                                </Trigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="False" />
                                        <Condition Property="IsPressed" Value="True" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="PART_Button" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderThickness" Value="{StaticResource MaterialDark.BorderThickness0111}" />
                                </MultiTrigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter TargetName="IconContent" Property="MinHeight" Value="20" />
                                    <Setter TargetName="IconContent" Property="MinWidth" Value="20" />
                                    <Setter TargetName="OuterBorder" Property="MinWidth" Value="47" />
                                    <Setter TargetName="OuterBorder" Property="MinHeight" Value="30" />
                                </Trigger>
                             </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="Background" Value="Transparent" />
            </MultiTrigger>

            <Trigger Property="SizeForm" Value="Large">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools:SplitButton}">
                            <Border
                                Name="OuterBorder"
                                BorderThickness="{StaticResource MaterialDark.BorderThickness1}"
                                IsEnabled="{TemplateBinding IsEnabled}"
                                Opacity="{TemplateBinding Opacity}">
                                <StackPanel Orientation="Vertical">
                                    <Border
                                        Name="PART_Button"
                                        Background="Transparent"
                                        BorderBrush="Transparent"
                                        BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                        Visibility="Collapsed">
                                        <ContentPresenter Name="IconContent" ContentTemplateSelector="{TemplateBinding IconTemplateSelector}"  ContentTemplate="{TemplateBinding IconTemplate}" Content="{Binding }" Height="32" Width="32"/>
                                    </Border>
                                    <tools:RibbonUIBorder
                                        Name="PART_ToggleButton"
                                        AutomationProperties.Name="DropDownButton"
                                        Background="{TemplateBinding Background}"
                                        BorderThickness="0,1,0,0"
                                        ToolTip="{TemplateBinding ToggleButtonToolTip}">
                                        <Grid>
                                            <tools:CustomItemsControl
                                                x:Name="label"
                                                Margin="0,2,0,2"
                                                Focusable="False"
                                                Foreground="{TemplateBinding Foreground}"
                                                ItemsSource="{Binding Path=Label, Mode=OneWay, Converter={StaticResource TextWrappingConverter}, RelativeSource={RelativeSource TemplatedParent}}"
                                                Path="{StaticResource DropDownPath}">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <tools:MultilinePanel HorizontalAlignment="{TemplateBinding HorizontalAlignment}" VerticalAlignment="{TemplateBinding VerticalAlignment}" />
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>
                                            </tools:CustomItemsControl>
                                        </Grid>
                                    </tools:RibbonUIBorder>
                                    <Popup
                                        Name="PART_Popup"
                                        AllowsTransparency="True"
                                        Focusable="False"
                                        IsOpen="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource AncestorType={x:Type tools:DropDownButton}}}"
                                        Placement="Bottom"
                                        PopupAnimation="Fade"
                                        StaysOpen="False">
                                        <Border x:Name="PART_Shadow" SnapsToDevicePixels="true">
                                            <Border
                                                MinWidth="28"
                                                MinHeight="14"
                                                Background="{StaticResource PopupBackground}"
                                                BorderBrush="{StaticResource BorderAlt}"
                                                BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                                Effect="{StaticResource Default.ShadowDepth3}">
                                                <Border.Margin>
                                                            <Thickness>8,0,8,8</Thickness>
                                                </Border.Margin>
                                                <ScrollViewer Style="{StaticResource WPFMenuScrollViewer}">
                                                    <ItemsPresenter
                                                        Name="Presenter"
                                                        Margin="0"
                                                        Grid.IsSharedSizeScope="true"
                                                        KeyboardNavigation.DirectionalNavigation="Cycle"
                                                        KeyboardNavigation.TabNavigation="Cycle"
                                                        SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                                </ScrollViewer>
                                            </Border>
                                        </Border>
                                    </Popup>
                                </StackPanel>
                            </Border>

                            <ControlTemplate.Triggers>
                                <MultiTrigger >
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="VectorImage"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource RibbonItemVectorImageTemplate}"/>
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="Icon"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                   <Setter TargetName="IconContent" Property="Tag" Value="{Binding LargeIcon, RelativeSource={RelativeSource TemplatedParent}}" />
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource SplitButtonIconTemplate}"/>
                                </MultiTrigger>
                                <Trigger Property="IsLargeImageVisible" Value="True">
                                    <Setter TargetName="PART_Button" Property="Visibility" Value="Visible" />
                                </Trigger>

                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />

                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_ToggleButton" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                </MultiTrigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                </MultiTrigger>

                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="False" />
                                        <Condition Property="IsPressed" Value="True" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                </MultiTrigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsPressed" Value="True" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                </MultiTrigger>

                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="IconContent" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter Property="Opacity" Value="0.5"/>
                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter Property="Padding" Value="5" />
                                    <Setter TargetName="IconContent" Property="MinHeight" Value="60" />
                                    <Setter TargetName="IconContent" Property="MinWidth" Value="48" />
                                    <Setter TargetName="label" Property="Margin" Value="0,11,0,2" />
                                    <Setter TargetName="OuterBorder" Property="MinWidth" Value="60" />
                                    <Setter TargetName="OuterBorder" Property="MinHeight" Value="100" />
                                </Trigger>
                             </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="Background" Value="Transparent" />
            </Trigger>

            <Trigger Property="tools:SimplifiedLayoutSettings.LayoutMode" Value="Simplified">
                <Setter Property="BorderThickness" Value="{StaticResource MaterialDark.BorderThickness}" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type tools:SplitButton}">
                            <Border x:Name="OuterBorder"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    Opacity="{TemplateBinding Opacity}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="14" />
                                    </Grid.ColumnDefinitions>

                                    <Border x:Name="PART_Button"
                                            Grid.Column="0" Margin="0"
                                            Background="Transparent"
                                            BorderBrush="Transparent"
                                            BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                            SnapsToDevicePixels="True">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <ContentPresenter Name="IconContent" HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
 ContentTemplateSelector="{TemplateBinding IconTemplateSelector}" ContentTemplate="{TemplateBinding IconTemplate}" Content="{Binding }" Height="20" Width="20"/>
                                            <tools:RibbonAutomatableTextBlock x:Name="label"
                                                       Grid.Column="1"
                                                       Margin="2,0,4,0"
                                                       HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                                                       VerticalAlignment="{TemplateBinding VerticalAlignment}"
                                                       Foreground="{TemplateBinding Foreground}"
                                                       Text="{TemplateBinding Label}" />
                                        </Grid>
                                    </Border>
                                    <tools:RibbonUIBorder AutomationProperties.Name="DropDownButton" x:Name="PART_ToggleButton"
                                            Grid.Column="2"
                                            Background="Transparent"
                                            BorderBrush="Transparent"
                                            BorderThickness="{StaticResource MaterialDark.BorderThickness}"
                                            ToolTip="{TemplateBinding ToggleButtonToolTip}">
                                        <Grid AutomationProperties.Name="DropDownButton">
                                            <Path Width="5" x:Name="path"
                                                  Height="3"
                                                  HorizontalAlignment="Center"
                                                  VerticalAlignment="Center"
                                                  Data="M0,0 L100.25,0 100.25,20 80,20 80,39.75 60.5,39.75 60.5,60 39.75,60 39.75,39.75 20.75,39.75 20.75,20 0,20 z"
                                                  Fill="{StaticResource IconColor}"
                                                  Focusable="False"
                                                  Stretch="Fill" />
                                        </Grid>
                                    </tools:RibbonUIBorder>
                                    <Popup
                                        Name="PART_Popup"
                                        AllowsTransparency="True"
                                        Focusable="False"
                                        IsOpen="{Binding Path=IsDropDownOpen, RelativeSource={RelativeSource AncestorType={x:Type tools:DropDownButton}}}"
                                        Placement="Bottom"
                                        PopupAnimation="Fade"
                                        StaysOpen="False">
                                        <Border
                                            MinWidth="28"
                                            MinHeight="14"
                                            Background="{StaticResource PopupBackground}"
                                            BorderBrush="{StaticResource BorderAlt}"
                                            BorderThickness="{StaticResource MaterialDark.BorderThickness1}"
                                            Effect="{StaticResource Default.ShadowDepth3}">
                                            <Border.Margin>
                                                        <Thickness>8,0,8,8</Thickness>
                                            </Border.Margin>
                                            <ScrollViewer Margin="1" Style="{StaticResource WPFMenuScrollViewer}">
                                                <ItemsPresenter
                                                    Name="Presenter"
                                                    Grid.IsSharedSizeScope="true"
                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                    KeyboardNavigation.TabNavigation="Cycle"
                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                            </ScrollViewer>
                                        </Border>
                                    </Popup>
                                </Grid>
                            </Border>

                            <ControlTemplate.Triggers>
                                <Trigger Property="Visibility" Value="Visible">
                                    <Setter Property="Height" Value="{Binding Path=ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type tools:RibbonBar}}}"/>
                                </Trigger>
                                 <MultiTrigger >
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="VectorImage"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource RibbonItemVectorImageTemplate}"/>
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IconTemplate" Value="{x:Null}"/>
                                        <Condition Property="IconType" Value="Icon"/>
                                        <Condition Property="IconTemplateSelector" Value="{x:Null}"/>
                                    </MultiTrigger.Conditions>
                                   <Setter TargetName="IconContent" Property="Tag" Value="{Binding MediumIcon, RelativeSource={RelativeSource TemplatedParent}}" />
                                    <Setter Property="ContentTemplate" TargetName="IconContent" Value="{StaticResource SplitButtonIconTemplate}"/>
									<Setter Property="Margin" TargetName="IconContent" Value="2"/>
									<Setter Property="Visibility" TargetName="IconContent" Value="Collapsed"/>
                                </MultiTrigger>
                                <Trigger Property="SizeForm" Value="ExtraSmall">
                                    <Setter TargetName="label" Property="Visibility" Value="Collapsed"/>
                                </Trigger>
                                <Trigger Property="IsSmallImageVisible" Value="True">
                                    <Setter TargetName="IconContent" Property="Visibility" Value="Visible" />
                                </Trigger>

                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                </Trigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_ToggleButton" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                </MultiTrigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="True" />
                                        <Condition Property="IsDropDownOpen" Value="False" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondaryHoverBackground}" />
                                </MultiTrigger>

                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="OuterBorder" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="OuterBorder" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />

                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition SourceName="PART_Button" Property="IsMouseOver" Value="False" />
                                        <Condition Property="IsPressed" Value="True" />
                                    </MultiTrigger.Conditions>
                                    <Setter TargetName="path" Property="Fill" Value="{StaticResource IconColor}" />
                                    <Setter TargetName="label" Property="Foreground" Value="{StaticResource SecondaryForeground}" />
                                    <Setter TargetName="PART_Button" Property="Background" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="PART_Button" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter Property="ToolTipService.IsEnabled" Value="False" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderBrush" Value="{StaticResource SecondarySelectionBackground}" />
                                    <Setter TargetName="PART_ToggleButton" Property="BorderThickness" Value="{StaticResource MaterialDark.BorderThickness0111}" />
                                </MultiTrigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="IconContent" Property="Effect" Value="{StaticResource DisableEffect}" />
                                    <Setter Property="Opacity" Value="0.5"/>

                                </Trigger>
                                <Trigger Property="shared:SkinStorage.EnableTouch" Value="True">
                                    <Setter TargetName="IconContent" Property="MinHeight" Value="20" />
                                    <Setter TargetName="IconContent" Property="MinWidth" Value="20" />
                                    <Setter TargetName="OuterBorder" Property="MinWidth" Value="47" />
                                    <Setter TargetName="OuterBorder" Property="MinHeight" Value="30" />
                                </Trigger>
                             </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>
        </Style.Triggers>
    </Style>
    <Style BasedOn="{StaticResource SyncfusionSplitButtonStyle}" TargetType="{x:Type tools:SplitButton}" />
    
</ResourceDictionary>
